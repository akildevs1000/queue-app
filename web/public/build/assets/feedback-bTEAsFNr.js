import{K as g,r as n,m as N,j as t}from"./app-Dh0n7yI5.js";const S=[{value:1,emoji:"😠"},{value:2,emoji:"😦"},{value:3,emoji:"😟"},{value:4,emoji:"😕"},{value:5,emoji:"😐"},{value:6,emoji:"🙂"},{value:7,emoji:"😊"},{value:8,emoji:"😀"},{value:9,emoji:"😃"},{value:10,emoji:"😍"}],k=()=>{const{success:s,error:l}=g().props,{auth:p}=g().props,f=n.useRef(null);n.useEffect(()=>{const e=new WebSocket("ws://192.168.3.245:7777");f.current=e,e.addEventListener("open",()=>{console.log("Connected to WS server")}),e.addEventListener("message",a=>{try{const{event:i,data:b}=JSON.parse(a.data);i==="feedback"&&p.user.counter_id==b.counter_id&&u("token_id",b.token_id)}catch{console.error("Failed to parse message:",a.data)}})},[]);const[h,o]=n.useState(!1),[c,d]=n.useState(!1),{data:r,setData:u,reset:j,post:w,processing:m,errors:x}=N({rating:null,token_id:null}),v=e=>{u("rating",e)};n.useEffect(()=>{if(s||l){o(!0);const e=setTimeout(()=>{o(!1)},5e3);return()=>clearTimeout(e)}},[s,l]);const y=e=>{e.preventDefault(),!(r.rating===null||r.token_id===null||c)&&w("/feedback",{onSuccess:()=>{j(),o(!0),d(!0);const a=setTimeout(()=>o(!1),5e3),i=setTimeout(()=>d(!1),6e4);return()=>{clearTimeout(a),clearTimeout(i)}}})};return t.jsxs("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:[t.jsxs("form",{onSubmit:y,className:"w-[700px] rounded-md border border-gray-300 bg-white p-4 text-center font-mono shadow-md",children:[t.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"How was your experience?"}),t.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:S.map(({value:e,emoji:a})=>t.jsx("button",{type:"button",onClick:()=>v(e),className:`h-12 w-10 rounded-md text-2xl transition-all ${r.rating===e?"scale-110 bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"}`,"aria-label":`Rate ${e}`,children:a},e))}),r.rating&&t.jsxs("p",{className:"mt-4 text-sm",children:["You selected: ",t.jsx("span",{className:"font-bold",children:r.rating})]}),x.rating&&t.jsx("p",{className:"mt-1 text-xs text-red-500",children:x.rating}),t.jsx("button",{type:"submit",disabled:m||r.rating===null||c,className:"mt-4 rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:opacity-50",children:m?"Submitting...":"Submit"})]}),h&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:t.jsxs("div",{className:`animate-pop rounded-xl border px-10 py-6 text-center shadow-2xl ${s?"border-green-300 bg-white":"border-red-300 bg-white"}`,children:[t.jsx("p",{className:`mb-2 text-3xl font-bold ${s?"text-green-600":"text-red-600"}`,children:s?"Success!":"Error!"}),t.jsx("p",{className:"text-lg text-gray-800",children:s||l})]})})]})};function E(){return t.jsx(k,{})}export{E as default};

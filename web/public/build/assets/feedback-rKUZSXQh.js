import{K as h,r as a,m as T,j as e}from"./app-ByoHfh73.js";const E=[{value:1,emoji:"ðŸ˜ "},{value:2,emoji:"ðŸ˜¦"},{value:3,emoji:"ðŸ˜Ÿ"},{value:4,emoji:"ðŸ˜•"},{value:5,emoji:"ðŸ˜"},{value:6,emoji:"ðŸ™‚"},{value:7,emoji:"ðŸ˜Š"},{value:8,emoji:"ðŸ˜€"},{value:9,emoji:"ðŸ˜ƒ"},{value:10,emoji:"ðŸ˜"}],_=()=>{const{success:n,error:c}=h().props,{auth:s}=h().props,w=a.useRef(null);a.useEffect(()=>{var l,g;let t=`ws://${(l=s==null?void 0:s.user)==null?void 0:l.ip}:${(g=s==null?void 0:s.user)==null?void 0:g.port}`;const r=new WebSocket(t);w.current=r,r.addEventListener("open",()=>{console.log("Connected to WS server")}),r.addEventListener("message",p=>{try{const{event:f,data:j}=JSON.parse(p.data);f==="feedback"&&s.user.counter_id==j.counter_id&&m("token_id",j.token_id)}catch{console.error("Failed to parse message:",p.data)}})},[]);const[v,i]=a.useState(!1),[d,u]=a.useState(!1),{data:o,setData:m,reset:y,post:N,processing:x,errors:b}=T({rating:null,token_id:null}),S=t=>{m("rating",t)};a.useEffect(()=>{if(n||c){i(!0);const t=setTimeout(()=>{i(!1)},5e3);return()=>clearTimeout(t)}},[n,c]);const k=t=>{t.preventDefault(),!(o.rating===null||o.token_id===null||d)&&N("/feedback",{onSuccess:()=>{y(),i(!0),u(!0);const r=setTimeout(()=>i(!1),5e3),l=setTimeout(()=>u(!1),6e4);return()=>{clearTimeout(r),clearTimeout(l)}}})};return e.jsxs("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:[e.jsxs("form",{onSubmit:k,className:"w-[700px] rounded-md border border-gray-300 bg-white p-4 text-center font-mono shadow-md",children:[e.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"How was your experience?"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:E.map(({value:t,emoji:r})=>e.jsx("button",{type:"button",onClick:()=>S(t),className:`h-12 w-10 rounded-md text-2xl transition-all ${o.rating===t?"scale-110 bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"}`,"aria-label":`Rate ${t}`,children:r},t))}),o.rating&&e.jsxs("p",{className:"mt-4 text-sm",children:["You selected: ",e.jsx("span",{className:"font-bold",children:o.rating})]}),b.rating&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:b.rating}),e.jsx("button",{type:"submit",disabled:x||o.rating===null||d,className:"mt-4 rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 disabled:opacity-50",children:x?"Submitting...":"Submit"})]}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:e.jsxs("div",{className:`animate-pop rounded-xl border px-10 py-6 text-center shadow-2xl ${n?"border-green-300 bg-white":"border-red-300 bg-white"}`,children:[e.jsx("p",{className:`mb-2 text-3xl font-bold ${n?"text-green-600":"text-red-600"}`,children:n?"Success!":"Error!"}),e.jsx("p",{className:"text-lg text-gray-800",children:n||c})]})})]})};function R(){return e.jsx(_,{})}export{R as default};

import{K as w,m as b,r as g,j as e,L as C}from"./app-BWHm7pyg.js";import{S as L,H as k}from"./layout-gTrYDnd9.js";import{I as i}from"./input-error-CUsCoia1.js";import{B as I}from"./button-BRCRbFlS.js";import{I as n}from"./input-BFyzTYtM.js";import{L as l}from"./label-B2Rg6_ZL.js";import{A as E}from"./app-layout-Dh7luSD5.js";import{S as M,a as F,b as R,c as U,f as u}from"./select-CPmlyO3b.js";import{z as W}from"./transition-C7JTyI21.js";import"./index-Cbg3v19s.js";import"./utils-jAU0Cazi.js";import"./index-CYHHy9QM.js";import"./app-logo-icon-DuV-PU51.js";import"./index-BtYAOiJi.js";const T=[{title:"Tv Settings",href:"/settings/tv-settings"}];function Q(){const{auth:o}=w().props,{data:t,setData:a,put:x,errors:r,processing:j,recentlySuccessful:v}=b({ip:o.user.ip,port:o.user.port,media_type:o.user.media_type||"image",media_url:o.user.media_url,media_height:o.user.media_height,media_width:o.user.media_width}),_=s=>{s.preventDefault(),x(route("tv_settings.update"),{preserveScroll:!0,onSuccess:()=>{p()}})},m=g.useRef(null),p=()=>{if(!(t!=null&&t.ip)||!(t!=null&&t.port)){console.warn("Missing IP or port");return}const s=`ws://${t.ip}:${t.port}`,d=new WebSocket(s);m.current=d,d.addEventListener("open",()=>{console.log("âœ… Connected to WS server");const c=parseInt(t.media_height,10),h=parseInt(t.media_width,10),N=typeof t.media_url=="string"?t.media_url.split(`
`).map(y=>y.trim()).filter(Boolean):[],S={event:"trigger-settings",data:{...t,media_height:isNaN(c)?0:c,media_width:isNaN(h)?0:h,media_url:N}};d.send(JSON.stringify(S))}),d.addEventListener("error",c=>{console.error("WebSocket error:",c)}),d.addEventListener("close",()=>{console.log("WebSocket connection closed")})},f=()=>{m.current&&(m.current.close(),m.current=null)};return g.useEffect(()=>(p(),()=>{f()}),[]),e.jsxs(E,{breadcrumbs:T,children:[e.jsx(C,{title:"TV settings"}),e.jsx(L,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(k,{title:"Update your tv settings",description:"update ip and port to connect to tv"}),e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"ip",children:"Ip Address"}),e.jsx(n,{id:"ip",className:"mt-1 block w-full",value:t.ip,onChange:s=>a("ip",s.target.value),required:!0,autoComplete:"ip",placeholder:"Ip Address"}),e.jsx(i,{className:"mt-2",message:r.ip})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"port",children:"Port"}),e.jsx(n,{id:"port",className:"mt-1 block w-full",value:t.port,onChange:s=>a("port",s.target.value),required:!0,autoComplete:"port",placeholder:"Port"}),e.jsx(i,{className:"mt-2",message:r.port})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"media_type",children:"Media Type"}),e.jsxs(M,{value:t.media_type,onValueChange:s=>a("media_type",s),children:[e.jsx(F,{className:"w-full",children:e.jsx(R,{placeholder:"Select media type"})}),e.jsxs(U,{children:[e.jsx(u,{value:"youtube",children:"YouTube"}),e.jsx(u,{value:"video",children:"Video"}),e.jsx(u,{value:"gif",children:"GIF"}),e.jsx(u,{value:"image",children:"Image (Multiple URLs)"})]})]}),e.jsx(i,{className:"mt-2",message:r.media_type})]}),t.media_type==="image"?e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"media_url",children:"Media URLs (Enter each URL and press Enter)"}),e.jsx("textarea",{id:"media_url",className:"mt-1 block w-full rounded border px-2 py-1 text-sm",rows:5,placeholder:"Paste each image URL and press Enter",value:t.media_url,onChange:s=>a("media_url",s.target.value.replace(/\r/g,""))}),e.jsx(i,{className:"mt-2",message:r.media_url})]}):e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"media_url",children:"Media URL"}),e.jsx(n,{id:"media_url",className:"mt-1 block w-full",value:t.media_url,onChange:s=>a("media_url",s.target.value),required:!0,autoComplete:"media_url",placeholder:"Media URL"}),e.jsx(i,{className:"mt-2",message:r.media_url})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"port",children:"Media Height"}),e.jsx(n,{id:"media_height",className:"mt-1 block w-full",value:t.media_height,onChange:s=>a("media_height",s.target.value),required:!0,autoComplete:"media_height",placeholder:"Media Height"}),e.jsx(i,{className:"mt-2",message:r.media_height})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"port",children:"Media Width"}),e.jsx(n,{id:"media_width",className:"mt-1 block w-full",value:t.media_width,onChange:s=>a("media_width",s.target.value),required:!0,autoComplete:"media_width",placeholder:"Media Width"}),e.jsx(i,{className:"mt-2",message:r.media_width})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{disabled:j,children:"Save & Connect"}),e.jsx(W,{show:v,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-neutral-600",children:"Saved"})})]})]})]})})]})}export{Q as default};

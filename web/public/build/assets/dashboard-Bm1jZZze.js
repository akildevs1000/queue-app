import{r,j as e,m as O,K as P,L as Q}from"./app-D2zEqdkZ.js";import{A as W,U as q}from"./app-layout-ChAqP0yv.js";import{B as p}from"./button-DJwtxuJh.js";import{D as z,a as J,b as X}from"./dialog-C_lUvbhA.js";import{G as Y}from"./GradientButton-DfmC8s_q.js";import{I as Z}from"./input-D6mxn7y9.js";import{T as ee,a as se,b as _,c as E,d as te,e as T}from"./table-MlszKQ7I.js";import{c as C}from"./app-logo-icon-4_n5hMOl.js";import"./utils-jAU0Cazi.js";import"./index-CpWgR35R.js";import"./index-DSBX6Sgb.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],re=C("Activity",ae);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],le=C("Clock",ne);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],ie=C("UserCheck",oe);function de(){const[n,d]=r.useState(null),[i,a]=r.useState(!0),x=async()=>{try{a(!0);const l=await(await fetch("/counter-by-user")).json();console.log("ðŸš€ ~ fetchLastLogin ~ json:",l),d(l)}catch(m){console.error("Failed to fetch last login",m)}finally{a(!1)}};return r.useEffect(()=>{x()},[]),e.jsx("div",{className:"",children:i?e.jsx("p",{className:"text-gray-500",children:"Loading..."}):n?e.jsx("div",{className:"space-y-2 text-sm",children:e.jsxs("p",{children:[" ",n.name]})}):e.jsx("p",{className:"text-gray-500",children:"---"})})}function ce(){const[n,d]=r.useState(null),[i,a]=r.useState(!0),x=async()=>{try{a(!0);const l=await(await fetch("/service-by-user")).json();console.log("ðŸš€ ~ fetchLastLogin ~ json:",l),d(l)}catch(m){console.error("Failed to fetch last login",m)}finally{a(!1)}};return r.useEffect(()=>{x()},[]),e.jsx("div",{className:"",children:i?e.jsx("p",{className:"text-gray-500",children:"Loading..."}):n?e.jsx("div",{className:"space-y-2 text-sm",children:e.jsxs("p",{children:[" ",n.name]})}):e.jsx("p",{className:"text-gray-500",children:"No login record found."})})}function xe({title:n,endpoint:d}){const[i,a]=r.useState(!1),{data:x,setData:m,processing:l,errors:g}=O({token_number_display:""}),h=t=>{t.preventDefault(),console.log("ðŸš€ ~ handleSubmit ~ token_number_display:",x.token_number_display)};return e.jsxs(z,{open:i,onOpenChange:a,children:[e.jsx(J,{asChild:!0,children:e.jsx(Y,{className:"w-1/2 rounded-lg bg-indigo-500 p-6 font-semibold text-white transition hover:bg-indigo-700 dark:border-gray-600 dark:bg-gray-800",children:n})}),e.jsxs(X,{children:[e.jsx("h2",{className:"text-xl font-bold",children:n}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"max-w-md",children:[e.jsx(Z,{placeholder:"Token",type:"text",value:x.token_number_display,onChange:t=>m("token_number_display",t.target.value)}),g.token_number_display&&e.jsx("p",{className:"pt-1 pl-1 text-sm text-red-400",children:g.token_number_display})]}),e.jsx(p,{className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white",type:"submit",disabled:l,children:l?"Submitting...":"Submit"})]})]})]})}const me=()=>{const{auth:n}=P().props,[d,i]=r.useState(null),[a,x]=r.useState(null),[m,l]=r.useState(!1),[g,h]=r.useState("Next"),[t,c]=r.useState("Recall"),[u,j]=r.useState(null),[M,A]=r.useState(null),[f,y]=r.useState(!1),[ue,be]=r.useState(!1),[N,w]=r.useState(0),[F,k]=r.useState(0),L=n.user||{name:"John Doe",email:"john@example.com"},D=async()=>{try{const o=await(await fetch("/token-counts")).json();i(o)}catch(s){console.error("Failed to fetch services",s)}},B=async()=>{try{const o=await(await fetch("/feedback-by-counter")).json();A(o)}catch(s){console.error("Failed to fetch services",s)}},$=s=>{const o=s==null?void 0:s.token_number_display;if(o){const b=`Token ${o}, please proceed to the counter.`;console.log(b);const v=new SpeechSynthesisUtterance(b);v.lang="en-US",speechSynthesis.speak(v)}else console.warn("No token information available to announce.")},R=async()=>{if(!(a!=null&&a.token_number_display))return;c(`Recalling ${a==null?void 0:a.token_number_display}`),$(a),l(!0);let s;return s=setTimeout(()=>{l(!1),c("Recall")},5e3),()=>clearTimeout(s)},U=()=>{if(f&&u!==null){const s=Date.now(),o=Math.floor((s-u)/1e3);w(b=>b+o),j(null),y(!1)}},V=()=>{!f&&a&&(j(Date.now()),y(!0))},H=()=>{f?U():V()},G=async()=>{if(!(a!=null&&a.token_number_display))return;let s=N;if(f&&u!==null){const o=Date.now();s+=Math.floor((o-u)/1e3)}console.log("Total time served:",S(s));try{await fetch(`/end-serving/${a==null?void 0:a.id}?total_serving_time_display=${S(s)}`),w(0),j(null),y(!1),k(0),x(null)}catch(o){console.error("Failed to fetch services",o)}},I=async()=>{try{await fetch(`/no-show-serving/${a==null?void 0:a.id}`),w(0),j(null),y(!1),k(0)}catch(s){console.error("Failed to fetch services",s)}},K=async()=>{l(!0),h("Calling Next");try{let s=null;if(a?s=a:s=await(await fetch("/next-token")).json(),s!=null&&s.id){x(s),j(Date.now()),y(!0);const b=await(await fetch(`/start-serving/${s.id}`)).json();console.log("Started serving:",b),$(s)}else console.warn("No next token received.")}catch(s){console.error("Failed to fetch services",s)}finally{let s;return s=setTimeout(()=>{l(!1),h("Next")},1e3),()=>clearTimeout(s)}},S=s=>{const o=String(Math.floor(s/3600)).padStart(2,"0"),b=String(Math.floor(s%3600/60)).padStart(2,"0"),v=String(s%60).padStart(2,"0");return`${o}:${b}:${v}`};return r.useEffect(()=>{let s;return f&&u!==null?s=setInterval(()=>{const o=Date.now(),b=Math.floor((o-u)/1e3);k(N+b)},1e3):k(N),()=>clearInterval(s)},[f,u,N]),r.useEffect(()=>{D();const s=setInterval(()=>{B(),D()},5e3);return()=>clearInterval(s)},[]),e.jsxs("div",{className:"flex h-full w-full px-15 text-gray-800 dark:bg-gray-900 dark:text-gray-900",children:[e.jsxs("div",{className:"flex w-1/2 flex-col justify-center",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("h2",{className:"mb-2 text-lg font-medium text-orange-600 dark:text-orange-400",children:"Current Serving"}),e.jsx("h1",{className:"mb-4 text-2xl font-bold text-blue-900 dark:text-blue-300",children:"Token Number"}),e.jsx("div",{className:"w-fit rounded-xl border-2 border-orange-500 px-12 py-6 text-[64px] font-bold text-orange-600 dark:border-orange-400 dark:text-orange-400",children:(a==null?void 0:a.token_number_display)??"---"}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("p",{className:"mb-1 text-sm text-gray-500 dark:text-gray-400",children:"Serving Time"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-900 dark:text-blue-300",children:[" ",S(F)]})]})]})}),e.jsxs("div",{className:"mt-8 flex justify-between text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-lg font-medium text-gray-500 dark:text-gray-400",children:"Total Served Tokens"}),e.jsx("p",{className:"text-xl font-bold text-blue-900 dark:text-blue-300",children:d==null?void 0:d.served})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-1 text-lg font-medium text-gray-500 dark:text-gray-400",children:"Total Pending"}),e.jsx("p",{className:"text-xl font-bold text-orange-600 dark:text-orange-400",children:d==null?void 0:d.pending})]})]})]}),e.jsx("div",{className:"mx-4 w-px bg-gray-300 dark:bg-gray-600"}),e.jsxs("div",{className:"flex h-full w-1/2 flex-col justify-center px-15",children:[e.jsxs("div",{className:"mb-10 flex flex-wrap gap-6 lg:flex-nowrap",children:[e.jsxs("div",{className:"w-full rounded-xl p-6 lg:w-3/2",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-blue-900 dark:text-blue-300",children:"Profile Info"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700 dark:text-gray-300",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400",children:"Name:"})," ",L.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400",children:"Email:"})," ",L.email]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400",children:"Service:"}),e.jsx("div",{children:e.jsx(ce,{})})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium text-gray-500 dark:text-gray-400",children:"Counter:"}),e.jsx(de,{})]})]})]}),e.jsxs("div",{className:"w-full rounded-xl p-6 lg:w-1/3",children:[e.jsx("h2",{className:"mb-4 text-xl font-semibold text-blue-900 dark:text-blue-300",children:"Performance"}),e.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.jsx("span",{className:"font-medium text-orange-600 dark:text-orange-400",children:e.jsx("b",{children:M})})})]})]}),e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsx(p,{onClick:K,className:"w-1/2 rounded-lg bg-indigo-500 p-6 font-semibold text-white transition hover:bg-indigo-700 dark:border-gray-600 dark:bg-gray-800",children:g}),e.jsx(p,{onClick:G,className:"w-1/2 rounded-lg bg-indigo-500 p-6 font-semibold text-white transition hover:bg-indigo-700 dark:border-gray-600 dark:bg-gray-800",children:"End"}),e.jsx(p,{onClick:I,className:"w-1/2 rounded-lg bg-indigo-500 p-6 font-semibold text-white transition hover:bg-indigo-700 dark:border-gray-600 dark:bg-gray-800",children:"No Show"}),e.jsx(p,{onClick:R,className:"w-1/2 rounded-lg bg-indigo-500 p-6 font-semibold text-white transition hover:bg-indigo-700 dark:border-gray-600 dark:bg-gray-800",children:t}),e.jsx(xe,{title:"Call Manual",endpoint:"call_manual"}),e.jsx(p,{onClick:H,className:"w-1/2 rounded-lg bg-indigo-500 p-6 font-semibold text-white transition hover:bg-indigo-700 dark:border-gray-600 dark:bg-gray-800",children:f?"Resume":"Pause"})]})]})]})};function ge(){const[n,d]=r.useState([]),[i,a]=r.useState({current_page:1,last_page:1,total:0}),[x,m]=r.useState(!0),l=async(g=1)=>{try{m(!0);const t=await(await fetch(`/login-logs?page=${g}`)).json();d(t.data),a({current_page:t.current_page,last_page:t.last_page,total:t.total})}catch(h){console.error("Failed to fetch login logs",h)}finally{m(!1)}};return r.useEffect(()=>{l()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 font-bold",children:"Login History"}),e.jsxs(ee,{children:[e.jsx(se,{children:e.jsxs(_,{children:[e.jsx(E,{children:"Date"}),e.jsx(E,{children:"IP Address"})]})}),e.jsx(te,{children:n.length?n.map((g,h)=>e.jsxs(_,{children:[e.jsx(T,{children:g.formatted_logged_in_at}),e.jsx(T,{children:g.ip_address})]},h)):e.jsx(_,{children:e.jsx(T,{colSpan:3,className:"py-6 text-center",children:x?"Loading...":"No login records found."})})})]}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsxs("div",{children:["Page ",i.current_page," of ",i.last_page]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(p,{variant:"outline",disabled:i.current_page===1,onClick:()=>l(i.current_page-1),children:"Previous"}),e.jsx(p,{variant:"outline",disabled:i.current_page===i.last_page,onClick:()=>l(i.current_page+1),children:"Next"})]})]})]})}const he=[{title:"Dashboard",href:"/dashboard"}];function Ce(){var g,h;const{auth:n}=P().props,d=[{title:"Total Visits Today",value:"320",icon:e.jsx(q,{className:"h-8 w-8 text-blue-500"})},{title:"Total in Queue",value:"22",icon:e.jsx(le,{className:"h-8 w-8 text-yellow-500"})},{title:"VIP Customers",value:"8",icon:e.jsx(ie,{className:"h-8 w-8 text-purple-500"})},{title:"Avg. Wait Time",value:"5 min",icon:e.jsx(re,{className:"h-8 w-8 text-green-500"})}],[i,a]=r.useState([]),x=async()=>{try{const c=await(await fetch("/tokens")).json();console.log("ðŸš€ ~ fetchTokenCounts ~ json:",c),a(c.data)}catch(t){console.error("Failed to fetch services",t)}};r.useEffect(()=>{x()},[]);const m=[{ticket:"V001",name:"Mr. Khan",counter:"1",status:"Serving"},{ticket:"V002",name:"Dr. Ayesha",counter:"VIP Lounge",status:"Waiting"}],l=[{name:"Counter A",ticket:"A101",status:"Serving"},{name:"Counter B",ticket:"B205",status:"Idle"},{name:"Counter C",ticket:"C309",status:"Serving"}];return e.jsxs(W,{breadcrumbs:he,children:[e.jsx(Q,{title:"Queue Management Dashboard"}),((g=n==null?void 0:n.user)==null?void 0:g.type)==="master"&&e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-4",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4",children:d.map((t,c)=>e.jsxs("div",{className:"flex items-center justify-between rounded-xl border p-4 shadow-sm dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:t.title}),e.jsx("p",{className:"mt-2 text-2xl font-semibold text-gray-900 dark:text-white",children:t.value})]}),e.jsx("div",{className:"ml-4",children:t.icon})]},c))}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"h-80 overflow-auto rounded-xl border border-gray-200 bg-[var(--background)] p-4 text-[var(--foreground)] dark:border-gray-700",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-800 dark:text-white",children:"Regular Customers"}),e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 text-left dark:border-gray-700",children:[e.jsx("th",{className:"p-2 font-medium",children:"Ticket No."}),e.jsx("th",{className:"p-2 font-medium",children:"Counter"})]})}),e.jsx("tbody",{children:i.map((t,c)=>{var u;return e.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700",children:[e.jsx("td",{className:"p-2 font-mono",children:t==null?void 0:t.token_number_display}),e.jsxs("td",{className:"p-2",children:["Counter ",(u=t==null?void 0:t.counter)==null?void 0:u.name]})]},c)})})]})]}),e.jsxs("div",{className:"h-80 overflow-auto rounded-xl border border-gray-200 bg-[var(--background)] p-4 text-[var(--foreground)] dark:border-gray-700",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-800 dark:text-white",children:"VIP Customers"}),e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 text-left dark:border-gray-700",children:[e.jsx("th",{className:"p-2 font-medium",children:"Ticket No."}),e.jsx("th",{className:"p-2 font-medium",children:"Name"}),e.jsx("th",{className:"p-2 font-medium",children:"Counter"}),e.jsx("th",{className:"p-2 font-medium",children:"Status"})]})}),e.jsx("tbody",{children:m.map((t,c)=>e.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700",children:[e.jsx("td",{className:"p-2 font-mono",children:t.ticket}),e.jsx("td",{className:"p-2",children:t.name}),e.jsx("td",{className:"p-2",children:t.counter}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`inline-block rounded px-2 py-1 text-xs font-semibold ${t.status==="Serving"?"bg-green-100 text-green-800 dark:bg-green-800/30 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-800/30 dark:text-yellow-300"}`,children:t.status})})]},c))})]})]}),e.jsxs("div",{className:"h-80 overflow-auto rounded-xl border border-gray-200 bg-[var(--background)] p-4 text-[var(--foreground)] dark:border-gray-700",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-800 dark:text-white",children:"Counters"}),e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 text-left dark:border-gray-700",children:[e.jsx("th",{className:"p-2 font-medium",children:"Counter"}),e.jsx("th",{className:"p-2 font-medium",children:"Ticket No."}),e.jsx("th",{className:"p-2 font-medium",children:"Status"})]})}),e.jsx("tbody",{children:l.map((t,c)=>e.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700",children:[e.jsx("td",{className:"p-2",children:t.name}),e.jsx("td",{className:"p-2 font-mono",children:t.ticket}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`inline-block rounded px-2 py-1 text-xs font-semibold ${t.status==="Serving"?"bg-green-100 text-green-800 dark:bg-green-800/30 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-800/30 dark:text-yellow-300"}`,children:t.status})})]},c))})]})]}),e.jsxs("div",{className:"h-80 overflow-auto rounded-xl border border-gray-200 bg-[var(--background)] p-4 text-[var(--foreground)] dark:border-gray-700",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-800 dark:text-white",children:"Counters"}),e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 text-left dark:border-gray-700",children:[e.jsx("th",{className:"p-2 font-medium",children:"Counter"}),e.jsx("th",{className:"p-2 font-medium",children:"Ticket No."}),e.jsx("th",{className:"p-2 font-medium",children:"Status"})]})}),e.jsx("tbody",{children:l.map((t,c)=>e.jsxs("tr",{className:"border-t border-gray-200 dark:border-gray-700",children:[e.jsx("td",{className:"p-2",children:t.name}),e.jsx("td",{className:"p-2 font-mono",children:t.ticket}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`inline-block rounded px-2 py-1 text-xs font-semibold ${t.status==="Serving"?"bg-green-100 text-green-800 dark:bg-green-800/30 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-800/30 dark:text-yellow-300"}`,children:t.status})})]},c))})]})]}),e.jsx("div",{className:"w-full rounded-lg border border-gray-100 bg-[var(--background)] p-4 p-6 text-[var(--foreground)] shadow dark:border-gray-700 dark:bg-gray-900",children:e.jsx(ge,{})})]})]}),((h=n==null?void 0:n.user)==null?void 0:h.type)==="user"&&e.jsx(me,{})]})}export{Ce as default};

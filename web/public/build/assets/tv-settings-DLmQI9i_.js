import{K as f,m as N,r as h,j as e,L as S}from"./app-BM17SL6E.js";import{S as w,H as y}from"./layout-CLxHxRHz.js";import{I as i}from"./input-error-Dp2FwbiW.js";import{B as b}from"./button-BXFefLiw.js";import{I as m}from"./input-B98t5mMV.js";import{L as l}from"./label-DvpiQTRX.js";import{A as C}from"./app-layout-TBiPHXAP.js";import{S as L,a as k,b as I,c as E,f as c}from"./select-5BBtgiwx.js";import{z as M}from"./transition-WqnivHU6.js";import"./index-DKudtaVT.js";import"./utils-jAU0Cazi.js";import"./index-wZHqMsqC.js";import"./app-logo-icon-CctcM8Qp.js";import"./index-BdTVOrtf.js";const F=[{title:"Tv Settings",href:"/settings/tv-settings"}];function J(){const{auth:o}=f().props,{data:t,setData:a,put:g,errors:r,processing:x,recentlySuccessful:j}=N({ip:o.user.ip,port:o.user.port,media_type:o.user.media_type||"image",media_url:o.user.media_url,media_height:o.user.media_height,media_width:o.user.media_width}),v=s=>{s.preventDefault(),g(route("tv_settings.update"),{preserveScroll:!0,onSuccess:()=>{p()}})},n=h.useRef(null),p=()=>{if(!(t!=null&&t.ip)||!(t!=null&&t.port)){console.warn("Missing IP or port");return}const s=`ws://${t.ip}:${t.port}`,d=new WebSocket(s);n.current=d,d.addEventListener("open",()=>{console.log("Connected to WS server");const u={event:"trigger-settings",data:{...t,media_height:parseInt(t.media_height),media_width:parseInt(t.media_width)}};d.send(JSON.stringify(u))}),d.addEventListener("error",u=>{console.error("WebSocket error:",u)}),d.addEventListener("close",()=>{console.log("WebSocket connection closed")})},_=()=>{n.current&&(n.current.close(),n.current=null)};return h.useEffect(()=>(p(),()=>{_()}),[]),e.jsxs(C,{breadcrumbs:F,children:[e.jsx(S,{title:"TV settings"}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(y,{title:"Update your tv settings",description:"update ip and port to connect to tv"}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"ip",children:"Ip Address"}),e.jsx(m,{id:"ip",className:"mt-1 block w-full",value:t.ip,onChange:s=>a("ip",s.target.value),required:!0,autoComplete:"ip",placeholder:"Ip Address"}),e.jsx(i,{className:"mt-2",message:r.ip})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"port",children:"Port"}),e.jsx(m,{id:"port",className:"mt-1 block w-full",value:t.port,onChange:s=>a("port",s.target.value),required:!0,autoComplete:"port",placeholder:"Port"}),e.jsx(i,{className:"mt-2",message:r.port})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"media_type",children:"Media Type"}),e.jsxs(L,{value:t.media_type,onValueChange:s=>a("media_type",s),children:[e.jsx(k,{className:"w-full",children:e.jsx(I,{placeholder:"Select media type"})}),e.jsxs(E,{children:[e.jsx(c,{value:"youtube",children:"YouTube"}),e.jsx(c,{value:"video",children:"Video"}),e.jsx(c,{value:"gif",children:"GIF"}),e.jsx(c,{value:"image",children:"Image (Multiple URLs)"})]})]}),e.jsx(i,{className:"mt-2",message:r.media_type})]}),t.media_type==="image"?e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"media_url",children:"Media URLs (Enter each URL and press Enter)"}),e.jsx("textarea",{id:"media_url",className:"mt-1 block w-full rounded border px-2 py-1 text-sm",rows:5,placeholder:"Paste each image URL and press Enter",value:t.media_url,onChange:s=>a("media_url",s.target.value.replace(/\r/g,""))}),e.jsx(i,{className:"mt-2",message:r.media_url})]}):e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"media_url",children:"Media URL"}),e.jsx(m,{id:"media_url",className:"mt-1 block w-full",value:t.media_url,onChange:s=>a("media_url",s.target.value),required:!0,autoComplete:"media_url",placeholder:"Media URL"}),e.jsx(i,{className:"mt-2",message:r.media_url})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"port",children:"Media Height"}),e.jsx(m,{id:"media_height",className:"mt-1 block w-full",value:t.media_height,onChange:s=>a("media_height",s.target.value),required:!0,autoComplete:"media_height",placeholder:"Media Height"}),e.jsx(i,{className:"mt-2",message:r.media_height})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(l,{htmlFor:"port",children:"Media Width"}),e.jsx(m,{id:"media_width",className:"mt-1 block w-full",value:t.media_width,onChange:s=>a("media_width",s.target.value),required:!0,autoComplete:"media_width",placeholder:"Media Width"}),e.jsx(i,{className:"mt-2",message:r.media_width})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{disabled:x,children:"Save & Connect"}),e.jsx(M,{show:j,enter:"transition ease-in-out",enterFrom:"opacity-0",leave:"transition ease-in-out",leaveTo:"opacity-0",children:e.jsx("p",{className:"text-sm text-neutral-600",children:"Saved"})})]})]})]})})]})}export{J as default};
